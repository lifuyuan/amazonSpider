# -*- coding: utf-8 -*-

# Define here the models for your spider middleware
#
# See documentation in:
# http://doc.scrapy.org/en/latest/topics/spider-middleware.html

import logging
from fake_useragent import UserAgent
from random import randint


class RandomUserAgentMiddleware(object):
    # 随即更换user_agent
    def __init__(self, crawler):
        super(RandomUserAgentMiddleware, self).__init__()
        self.ua = UserAgent()
        self.ua_type = crawler.settings.get('RANDOM_UA_TYPE', 'random')

    @classmethod
    def from_crawler(cls, crawler):
        return cls(crawler)

    def process_request(self, request, spider):
        def get_ua():
            ''' Gets random UA based on the type setting (random, firefox…) '''
            return getattr(self.ua, self.ua_type)

        request.headers.setdefault('User-Agent', get_ua())


class RandomProxyMiddleware(object):

    def process_request(self, request, spider):
        ips = ['114.239.120.245:4355','180.121.232.15:4324','182.34.187.176:4382','180.121.199.235:4324','122.242.132.42:4399','123.169.166.40:4306','112.122.217.198:4392','113.128.31.129:4337','183.164.250.66:4352','183.146.221.41:4399','119.132.24.29:4328','144.255.245.131:4319','121.62.48.155:4308','125.67.70.218:4320','180.110.135.17:4369','123.134.248.48:4348','117.90.3.123:4380','112.85.72.237:4357','14.211.240.65:4328','123.169.162.132:4306','49.70.42.53:4355','36.26.151.161:4348','113.121.23.175:4366','220.186.164.3:4387','175.166.90.76:4329','49.68.70.0:4390','119.114.239.225:4367','42.53.99.140:4329','123.134.253.33:4348','123.152.37.176:4328','112.240.178.64:4388','49.82.251.33:4390','111.72.104.111:4397','220.177.172.36:4397','122.4.43.22:4337','1.70.112.138:4387','36.26.147.90:4348','117.90.1.118:4380','182.105.120.28:4317','220.186.184.22:4387','122.4.41.1:4337','112.85.56.94:4357','58.243.15.29:4392','180.127.217.122:4346','111.72.115.81:4397','58.243.15.151:4392','61.166.248.43:4350','113.121.44.112:4366','182.117.228.160:4381','182.47.217.170:4366','60.189.147.54:4389','123.169.164.143:4306','123.152.36.240:4328','222.188.188.221:4387','118.119.96.2:4330','122.4.41.216:4337','180.120.191.212:4324','114.230.130.158:4382','112.112.209.230:4350','125.67.245.28:4330','42.57.149.21:4329','117.87.71.75:4390','123.188.116.197:4388','110.166.238.83:4310','114.231.140.28:4324','182.107.112.220:4317','180.110.135.142:4369','125.67.71.233:4320','180.122.232.118:4398','117.91.238.149:4382','180.109.39.156:4369','180.122.232.247:4398','182.127.111.210:4331','180.109.32.119:4369','58.243.8.70:4392','182.35.24.123:4323','113.74.112.36:4328','123.156.177.163:4345','175.150.234.51:4366','113.239.152.84:4329','180.121.138.73:4324','114.239.201.171:4355','183.154.220.49:4399','49.70.18.50:4355','175.149.223.20:4367','218.89.96.26:4320','58.243.28.30:4347','122.194.235.115:4357','114.239.124.51:4355','60.174.19.9:4302','218.5.207.11:4359','182.35.27.109:4323','117.91.209.196:4382','180.109.37.181:4369','222.185.15.2:4387','117.94.64.90:4398','115.227.11.132:4376','117.37.18.139:4320','112.123.248.223:4347','119.186.244.3:4351']
        get_ip = "https://" + ips[randint(0, 99)]
        request.meta['proxy'] = get_ip

